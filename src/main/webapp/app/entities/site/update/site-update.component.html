<div class="mt-5 border-top pt-4">
  <h3>üìÇ Importer les sites via un fichier Excel</h3>
  <!-- Indication des colonnes attendues -->
  <p>
    Merci de pr√©parer votre fichier Excel avec les colonnes suivantes (dans cet ordre) :<br />
    <strong>nomSite, longitude, latitude, gestionnaire, proprietaire, codeOCI, typeSite</strong>
  </p>
  <!-- S√©lecteur de fichier -->
  <input type="file" class="form-control w-auto" (change)="onFileChange($event)" accept=".xlsx, .xls" />
  <p *ngIf="fileName" class="mt-2">
    Fichier s√©lectionn√© : <strong>{{ fileName }}</strong>
  </p>

  <!-- Boutons Importer et Annuler -->
  <div class="mt-2">
    <button class="btn btn-success me-2" (click)="saveImportedSites()" [disabled]="isLoading || importedSites.length === 0">
      {{ isLoading ? 'Importation en cours...' : 'Importer les sites' }}
    </button>

    <button class="btn btn-secondary" (click)="cancelImport()" [disabled]="isLoading && importedSites.length === 0">Annuler</button>
  </div>

  <!-- Aper√ßu du contenu import√© -->
  <table class="table table-bordered table-sm mt-3" *ngIf="importedSites.length > 0">
    <thead class="table-light">
      <tr>
        <th>Nom du site</th>
        <th>Code OCI</th>
        <th>Longitude</th>
        <th>Latitude</th>
        <th>Gestionnaire</th>
        <th>Propri√©taire</th>
        <th>Type</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let site of importedSites">
        <td>{{ site.nomSite }}</td>
        <td>{{ site.codeOCI }}</td>
        <td>{{ site.longitude }}</td>
        <td>{{ site.latitude }}</td>
        <td>{{ site.gestionnaire }}</td>
        <td>{{ site.proprietaire }}</td>
        <td>{{ site.typeSite }}</td>
      </tr>
    </tbody>
  </table>
</div>
